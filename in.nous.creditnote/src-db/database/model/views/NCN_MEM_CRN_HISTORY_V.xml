<?xml version="1.0"?>
  <database name="VIEW NCN_MEM_CRN_HISTORY_V">
    <view name="NCN_MEM_CRN_HISTORY_V"><![CDATA[SELECT DISTINCT inv.c_invoice_id AS ncn_mem_crn_history_v_id, inv.ad_client_id, inv.ad_org_id, inv.isactive, inv.created, inv.createdby, inv.updated, inv.updatedby, inv.issotrx, inv.documentno, inv.docstatus, inv.processed, inv.c_doctype_id, inv.dateinvoiced, inv.c_order_id, inv.c_bpartner_id, inv.c_bpartner_location_id, inv.c_currency_id, inv.totallines, inv.grandtotal, COALESCE(o.em_ncn_crtype, rr.name) AS return_reason, bp.em_rc_email AS email, bp.em_rc_mobile AS mobile, to_char(bp.em_rc_landline) AS landlineno FROM c_invoice inv JOIN c_order o ON o.c_order_id = inv.c_order_id JOIN c_return_reason rr ON rr.c_return_reason_id = o.c_return_reason_id LEFT JOIN c_bpartner bp ON bp.c_bpartner_id = inv.c_bpartner_id WHERE inv.issotrx = 'Y' AND o.issotrx = 'Y' AND inv.documentno LIKE 'CRN-%' AND (inv.docstatus IN ('CO', 'CL')) AND inv.processed = 'Y' ORDER BY inv.documentno]]></view>
  </database>
